<div class="container mt-4">
  <h1 class="text-center mb-4">Quản lý quyền người dùng</h1>

  <!-- Form tìm kiếm và nút lọc -->
  <div class="row mb-3">
    <div class="col-12 col-md-6 mb-3">
      <%= search_form_for @q, url: role_manager_users_path, method: :get, html: { class: "d-flex align-items-center" } do |f| %>
        <!-- Ô nhập liệu -->
        <%= f.text_field :name_or_email_cont, class: "form-control me-2", placeholder: "Tìm kiếm tên hoặc email" %>
        <!-- Nút tìm kiếm -->
        <%= f.submit "Tìm kiếm", class: "btn btn-secondary" %>
      <% end %>
    </div>
    <div class="col-12 col-md-6 text-md-end">
      <div class="btn-group flex-wrap">
        <%= link_to "Lọc Admin", role_manager_users_path(q: { system_role_role_name_eq: "admin" }), class: "btn btn-primary mb-2 " %>
        <%= link_to "Lọc User", role_manager_users_path(q: { system_role_role_name_eq: "user" }), class: "btn btn-success mb-2 ms-2" %>
        <%= link_to "Hiển thị tất cả", role_manager_users_path, class: "btn btn-outline-secondary mb-2 ms-2" %>
      </div>
    </div>
  </div>

  <!-- Bảng danh sách người dùng -->
  <div class="table-responsive">
    <table class="table table-bordered table-hover">
      <thead>
      <tr>
        <th>Tên</th>
        <th>Email</th>
        <th>Quyền</th>
        <th>Hành động</th>
      </tr>
      </thead>
      <tbody>
      <% @users.each do |user| %>
        <tr data-user-id="<%= user.id %>">
          <td><%= user.name %></td>
          <td><%= user.email %></td>
          <td>
            <select class="form-select role-select" data-user-id="<%= user.id %>">
              <% @roles.each do |role| %>
                <option value="<%= role.id %>" <%= "selected" if user.system_role_id == role.id %>>
                  <%= role.role_name.titleize %>
                </option>
              <% end %>
            </select>
          </td>
          <td>
            <button class="btn btn-danger btn-sm delete-user">Xóa</button>
          </td>
        </tr>
      <% end %>
      </tbody>
    </table>
  </div>

  <!-- Phân trang -->
  <nav>
    <%= paginate @users %>
  </nav>
</div>
