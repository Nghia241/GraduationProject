<div class="container mt-5">
  <h1 class="text-center mb-4 text-primary">
    <i class="fas fa-user-cog me-2"></i>Quản lý quyền người dùng
  </h1>

  <!-- Form tìm kiếm và nút lọc -->
  <div class="row mb-4 align-items-center">
    <div class="col-12 col-md-6 mb-3">
      <%= search_form_for @q, url: role_manager_users_path, method: :get, html: { class: "d-flex align-items-center" } do |f| %>
        <div class="input-group">
          <span class="input-group-text bg-light"><i class="fas fa-search"></i></span>
          <%= f.text_field :name_or_email_cont, class: "form-control", placeholder: "Tìm kiếm tên hoặc email" %>
          <button class="btn btn-secondary">
            <i class="fas fa-search"></i> Tìm kiếm
          </button>
        </div>
      <% end %>
    </div>
    <div class="col-12 col-md-6 text-md-end">
      <div class="btn-group">
        <%= link_to "Lọc Admin", role_manager_users_path(q: { system_role_role_name_eq: "admin" }), class: "btn btn-primary" %>
        <%= link_to "Lọc User", role_manager_users_path(q: { system_role_role_name_eq: "user" }), class: "btn btn-success" %>
        <%= link_to "Hiển thị tất cả", role_manager_users_path, class: "btn btn-outline-secondary" %>
      </div>
    </div>
  </div>

  <!-- Bảng danh sách người dùng -->
  <div class="table-responsive shadow-sm">
    <table class="table table-striped table-hover">
      <thead class="table-dark">
      <tr>
        <th><i class="fas fa-user"></i> Tên</th>
        <th><i class="fas fa-envelope"></i> Email</th>
        <th><i class="fas fa-user-tag"></i> Quyền</th>
        <th class="text-center"><i class="fas fa-tools"></i> Hành động</th>
      </tr>
      </thead>
      <tbody>
      <% @users.each do |user| %>
        <tr data-user-id="<%= user.id %>">
          <td><%= user.name %></td>
          <td><%= user.email %></td>
          <td>
            <select class="form-select role-select" data-user-id="<%= user.id %>">
              <% @roles.each do |role| %>
                <option value="<%= role.id %>" <%= "selected" if user.system_role_id == role.id %>>
                  <%= role.role_name.titleize %>
                </option>
              <% end %>
            </select>
          </td>
          <td class="text-center">
            <button class="btn btn-danger btn-sm delete-user">
              <i class="fas fa-trash-alt"></i> Xóa
            </button>
          </td>
        </tr>
      <% end %>
      </tbody>
    </table>
  </div>

  <!-- Phân trang -->
  <div class="mt-4">
    <%= paginate @users %>
  </div>
</div>
